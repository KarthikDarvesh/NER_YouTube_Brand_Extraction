# üß† NER_YouTube_Brand_Extraction

---

## üìã Overview
A fully automated pipeline that extracts brand mentions from YouTube video transcripts using an LLM (OLLAMA LLAMA 3.1: 8B), and stores the structured output into a PostgreSQL database.

---

## üîß Workflow Breakdown

### üü¢ Primary Workflow

<img width="1284" alt="image" src="https://github.com/user-attachments/assets/2ff93347-b3a2-4fe7-b7e7-7d4fcf086c05" />

1. **Trigger (Manual):**  
  Starts the workflow when the user manually clicks ‚ÄúTest Workflow.‚Äù

2. **PostgreSQL Query Node:**  
  Fetches enriched video and transcript data with necessary joins.
  -	Performs an inner join across video_details, video_transcripts, and channel_details.
  -	Strategy: From a particular channel (in channel_details), fetch all associated videos (from video_details) and then retrieve their transcripts (from video_transcripts).
  -	At the end, the query limits the selection to 2000 videos that have available transcripts but have not yet been processed for brand mentions.
    
3. **Edit Fields Node:**  
  Transforms the data by adding, removing, renaming, rearranging, or modifying fields.
  - In this case, it rearranges fields as needed for the next steps.
 
4. **Loop Over Items Node:**  
  From the 2000 fetched items, the Loop Over Items node divides the data into batches of 1 item each.
  - Each single item is then passed individually to the Execute Workflow (sub-workflow) for further processing.

5. **Execute Workflow Node (Sub-Workflow Trigger):**  
  - Triggers the brand extraction sub-workflow for each individual item.

6. **Wait Node:**  
  Waits for 5 seconds after each sub-workflow finishes processing.
  - Once a sub-workflow completes, it pauses for 5 seconds before proceeding to the next item from the Loop Over Items node and triggering the Execute Workflow Node again

---

### üü† Secondary Workflow (Sub-Workflow)

![Screenshot 2025-05-02 112840](https://github.com/user-attachments/assets/c233369c-9e4c-47ee-8e0e-ee30c1c30608)

1. **Execute Workflow Trigger Node:**  
  Entry point that is triggered by the parent (primary) workflow for each item.

2. **AI Agent Node (Ollama LLaMA 3.1):**  
  - Processes the transcript using the LLAMA 3.1 model via Ollama to identify brand mentions.
    -	Model: Ollama - Llama 3.1:8B

3. **Edit Fields Node:**  
  Modifies the data by:
  - Selecting video_id and yt_video_id from the primary workflow (Postgres query output).
  - Merging them with the output generated by the AI Agent.
  - Result: A merged structure containing video_id, yt_video_id, and the AI-generated brand mention output.

4. **Code Node (JavaScript):**  
Cleans and parses the LLM output into a structured format (likely JSON).
  - Actions performed:
    - Removes newline characters.
    - Removes backticks.
    - Trims extra whitespace.

5. **Postgres Node:**  
  Inserts the cleaned and structured brand mention entities into the brand_mention_entity table in the database.

  
